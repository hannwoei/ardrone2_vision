<!DOCTYPE module SYSTEM "../module.dtd">

<module name="OpenCV">
  <doc>
    <description>Video ARDone 2</description>
  </doc>

  <header>
    <file name="opencv_module.h"/>
  </header>

  <init fun="opencv_module_init()"/>

  <periodic fun="opencv_module_run()" freq="60" autorun="FALSE"/>
  <makefile>
    <define name="ARDRONE_VIDEO_PORT" value="2002" />
    <define name="USE_ARDRONE_VIDEO" />  
    <define name="USE_FMS" value="0"/>
    <!--<file name="opencv_module.c"/>-->  
      <raw>
include $(PAPARAZZI_HOME)/sw/ext/ardrone2_vision/Makefile.paths
VISION_MODULE_FOLDER = $(DIR_MODULES)/OpenCV/
OPENCV_INSTALL = /home/h2w/OMAP/thirdParty/opencv_install_ardrone/install/
OPENCV_SRC = /home/h2w/OMAP/thirdParty/opencv-2.4.7/
      	     	
$(TARGET).CFLAGS += -I$(DIR_MODULES) -I$(DIR_CV) -I$(DIR_LIB) -pthread -D__USE_GNU 
$(TARGET).CXXFLAGS += -I$(PAPARAZZI_HOME)/sw/include/ -I$(PAPARAZZI_SRC)/sw/airborne -I$(PAPARAZZI_SRC)/conf/autopilot -I$(PAPARAZZI_SRC)/sw/airborne/arch/$($(TARGET).ARCHDIR) -I$(VARINCLUDE) -I$(ACINCLUDE) -I$(PAPARAZZI_SRC)/sw/airborne/modules/
$(TARGET).CXXFLAGS += -I$(DIR_MODULES) -I$(DIR_CV) -I$(DIR_LIB) -pthread -D__USE_GNU

$(TARGET).CFLAGS += -I$(OPENCV_SRC)/include/
$(TARGET).CFLAGS += -I$(OPENCV_SRC)/modules/highgui/include/
$(TARGET).CFLAGS += -I$(OPENCV_SRC)/modules/core/include/
$(TARGET).CFLAGS += -I$(OPENCV_SRC)/modules/imgproc/include/

$(TARGET).CXXFLAGS += -I$(OPENCV_SRC)/include/
$(TARGET).CXXFLAGS += -I$(OPENCV_SRC)/modules/highgui/include/
$(TARGET).CXXFLAGS += -I$(OPENCV_SRC)/modules/core/include/   
$(TARGET).CXXFLAGS += -I$(OPENCV_SRC)/modules/imgproc/include/     	   	

$(TARGET).srcs += $(DIR_LIB)/v4l/video.c   	
$(TARGET).srcs += $(VISION_MODULE_FOLDER)/opencv_module.c
$(TARGET).srcs += $(VISION_MODULE_FOLDER)/opencv_code.c   
      	
$(TARGET).cpp_srcs += $(VISION_MODULE_FOLDER)/dummy.c
      	
#$(TARGET).LDFLAGS += -lstdc++ -lrt -lpthread -lm -ldl      	
LDFLAGS += -static -ldl -lm -lstdc++ -lrt -lpthread    	      	
LDFLAGS +=  -L$(OPENCV_INSTALL)/lib/ -L$(OPENCV_INSTALL)/share/OpenCV/3rdparty/lib/
LDFLAGS += -lopencv_highgui -lopencv_core -lopencv_imgproc -llibjasper -lIlmImf -lzlib -llibtiff -llibpng -llibjpeg -lrt         	   	
      	 	
	</raw>
	
	
  </makefile>
</module>

